<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="keywords" content="">
    <title>用户注册</title>
    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/fontello.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/animsition.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700|Merriweather:300,300i,400,400i,700,700i" rel="stylesheet">
    <!-- owl Carousel Css -->
    <link href="../css/owl.carousel.css" rel="stylesheet">
    <link href="../css/owl.theme.css" rel="stylesheet">
</head>

<body class="animsition">
    <div class="top-bar">
        <!-- top-bar -->
        <div class="container">
            <div class="row" style="font-size: 17px;">
                <div class="col-md-4 hidden-xs hidden-sm">
                    <p class="mail-text">欢迎登录马六甲P2P网贷</p>
                </div>
                <div class="col-md-8 col-sm-12 text-right col-xs-12">
                    <div class="top-nav"> 
						<span class="top-text"><a href="#">已有账号，去登录</a></span> 
					</div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.top-bar -->
    <div class="header">
        <div class="container">
            <div class="row">
                <div class="col-md-2 col-sm-12 col-xs-6">
                    <!-- logo -->
                    <div class="logo">
                        <a href="index.html"><img src="../images/logo.png" alt="Borrow - Loan Company Website Template"></a>
                    </div>
                </div>
                <!-- logo -->
                <div class="col-md-9 col-sm-12 col-xs-12">
                    <div id="navigation">
                        <!-- navigation start-->
                        <ul>
                            <li class="active"><a href="index.html" class="animsition-link">主页</a></li>
                            <li><a href="#" class="animsition-link">链接1</a></li>
                            <li><a href="#" class="animsition-link">链接2</a></li>
                            <li><a href="#" class="animsition-link">链接3</a></li>
                            <li><a href="#" class="animsition-link">链接4</a></li>
                        </ul>
                    </div>
                    <!-- /.navigation start-->
                </div>
                <div class="col-md-1 hidden-sm">
                    <!-- search start-->
                    <div class="search-nav"> <a class="search-btn" role="button" data-toggle="collapse" href="#searchbar" aria-expanded="false"><i class="fa fa-search"></i></a> </div>
                </div>
                <!-- /.search start-->
            </div>
        </div>
    </div>

	<div>
		<div style="margin-top:30px;margin-left:200px;margin-bottom:30px;width:550px;">
		<form>
		  <div class="form-group">
			<label>用户名&nbsp;&nbsp;&nbsp;<span id="spanOne"></span></label>
			<input type="text" class="form-control" id="userName" placeholder="用户名4-12位，必须以字母开头，不能带有中文和特殊字符">
			<input type="button" class="btn btn-primary btn-sm" value="查看用户名是否被注册" id="checkExist">
              &nbsp;&nbsp;&nbsp;<span id="spanZro"></span>
		  </div>
		  <div class="form-group">
			<label>密码&nbsp;&nbsp;&nbsp;<span id="spanTwo"></span></label>
			<input type="password" class="form-control" id="userPsw" placeholder="密码长度为6-16位，可以是字母、数字或字母和数字的组合">
		  </div>
		  <div class="form-group">
			<label>确认密码&nbsp;&nbsp;&nbsp;<span id="spanThr"></span></label>
			<input type="password" class="form-control" id="userPswAno" placeholder="请再次输入密码">
		  </div>
		  <div class="form-group">
		  	<label>手机号&nbsp;&nbsp;&nbsp;<span id="spanFur"></span></label>
		  	<input type="text" class="form-control" id="userPhone" placeholder="请输入正确的手机号码">
		  </div>	  
		  <div class="form-group">
		  	<input type="button" class="btn btn-primary btn-sm" id="sendCode" value="发送验证码">
              &nbsp;&nbsp;&nbsp;<span id="spanFve"></span>
		  	<input type="text" class="form-control" id="checkCode" placeholder="请输入验证码">
		  </div>
		  <div class="form-group">
		    <label>推荐人</label>
		    <input type="text" class="form-control" id="recPeople" placeholder="此项为非必填项">
		  </div>
		  <input type="button" class="btn btn-default btn-sm" id="canRegister" value="注册">
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="checkbox" checked>同意<a href="#">马六甲用户使用协议</a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <span id="submitSpan"></span>
		</form>
	</div>

    <!-- /.footer -->
    <div class="tiny-footer">
        <!-- tiny footer -->
        <div class="container" style="font-size: 15px;">
            <div class="row">
                <div class="col-md-6 col-sm-6 col-xs-6">
                    <p>©2018 亿人宝 All rights reserved   |   河南省马六甲投资管理有限公司</p>
                </div>
                <div class="col-md-6 col-sm-6 text-right col-xs-6">
                    </br><p>Team of Class QY88 | Group 2</p>
                </div>
            </div>
        </div>
    </div>
    <!-- /.tiny footer -->

    <style>
        span {color:firebrick;}
    </style>

    <!-- back to top icon -->
    <a href="#0" class="cd-top" title="Go to top">Top</a>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="../js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/menumaker.js"></script>
    <!-- animsition -->
    <script type="text/javascript" src="../js/animsition.js"></script>
    <script type="text/javascript" src="../js/animsition-script.js"></script>
    <!-- sticky header -->
    <script type="text/javascript" src="../js/jquery.sticky.js"></script>
    <script type="text/javascript" src="../js/sticky-header.js"></script>
    <!-- slider script -->
    <script type="text/javascript" src="../js/owl.carousel.min.js"></script>
    <script type="text/javascript" src="../js/slider-carousel.js"></script>
    <script type="text/javascript" src="../js/service-carousel.js"></script>
    <!-- Back to top script -->
    <script src="../js/back-to-top.js" type="text/javascript"></script>

    <script>
        //用户名格式校验
        $("#userName").blur(function () {
            var reg = /^[a-zA-Z]{1}\w+$/;
            if ($("#userName").val() == null || $("#userName").val() == "") {
                $("#spanOne").html("用户名不能为空！");
            } else if (reg.test($("#userName").val()) && $("#userName").val().length >= 4 && $("#userName").val().length <= 12) {
                $("#spanOne").html("用户名格式正确！");
            } else {
                $("#spanOne").html("用户名格式不正确！");
            }
        });
        //用户名唯一性校验
        $("#checkExist").click(function () {
            $.post("/forwardUser/userExist", {userName:$("#userName").val()}, function (data) {
                if (data > 0) {
                    $("#spanZro").html("该用户名已被注册！");
                } else {
                    $("#spanZro").html("该用户名可以使用！");
                }
            });
        });
        //密码格式校验
        $("#userPsw").blur(function () {
            var reg = /^\w+$/;
            if ($("#userPsw").val() == null || $("#userPsw").val() == "") {
                $("#spanTwo").html("密码不能为空！");
            } else if (reg.test($("#userPsw").val()) && $("#userPsw").val().length >= 6 && $("#userPsw").val().length <= 16) {
                $("#spanTwo").html("密码格式正确！");
            } else {
                $("#spanTwo").html("密码格式不正确！");
            }
        });
        //再次输入密码一致性校验
        $("#userPswAno").blur(function () {
            if ($("#userPswAno").val() != $("#userPsw").val()) {
                $("#spanThr").html("两次输入的密码不一致！");
            } else {
                $("#spanThr").html("密码有效！");
            }
        });
        //手机号格式校验
        $("#userPhone").blur(function () {
            var reg = /^1[3-9][0-9]{9}$/;
            if ($("#userPhone").val() == null || $("#userPhone").val() == "") {
                $("#spanFur").html("手机号不能为空！");
            } else if (reg.test($("#userPhone").val())) {
                $("#spanFur").html("手机号格式正确！");
            } else {
                $("#spanFur").html("手机号格式不正确！");
            }
        });
        //手机验证码发送
        var realCode = null;
        $("#sendCode").click(function() {
            var reg = /^1[3-9][0-9]{9}$/;
            if (!reg.test($("#userPhone").val())) {
                alert("请输入正确的手机号");
            } else {
                $.post("/forwardUser/telExist", {
                    tel : $("#userPhone").val()
                }, function (data) {
                    if (data > 0) {
                        $("#spanFve").html("该手机号已被注册！");
                    } else {
                        $("#spanFve").html("该手机号可以使用！");
                        $.post("/forwardUser/sendCode", {
                            tel : $("#userPhone").val()
                        }, function (data) {
                            realCode = data;
                        });
                        var time = 15;
                        var t = setInterval(function() {
                            $("#sendCode").prop("disabled", true);
                            $("#sendCode").val((time--)+"秒后重新发送");
                            if (time == 0) {
                                $("#sendCode").prop("disabled", false);
                                $("#sendCode").val("发送验证码");
                                clearInterval(t);
                            }
                        }, 1000);
                    }
                });
            }
        });
        //手机验证码校验
        $("#checkCode").blur(function () {
            if ($("#checkCode").val() == realCode) {
                $("#spanFve").html("验证码正确！");
            } else {
                $("#spanFve").html("验证码错误！");
            }
        });
        //注册
        $("#canRegister").click(function () {
            var formCode = 0;
            if ($("#spanZro").html() == "该用户名可以使用！") {
                formCode += 1;
            }
            if ($("#spanOne").html() == "用户名格式正确！") {
                formCode += 1;
            }
            if ($("#spanTwo").html() == "密码格式正确！") {
                formCode += 1;
            }
            if ($("#spanThr").html() == "密码有效！") {
                formCode += 1;
            }
            if ($("#spanFur").html() == "手机号格式正确！") {
                formCode += 1;
            }
            if ($("#spanFve").html() == "验证码正确！") {
                formCode += 1;
            }
            if (formCode != 6) {
                $("#submitSpan").html("请核实输入的内容是否完全正确");
            } else {
                $.post("/forwardUser/addForwardUser", {
                    userName : $("#userName").val(),
                    userPsw : $("#userPsw").val(),
                    userPhone : $("#userPhone").val(),
                    recPeople : $("#recPeople").val()
                }, function (data) {
                    if (data > 0) {
                        alert("注册成功！");
                    }
                });
            }
        });
    </script>

</body>

</html>
